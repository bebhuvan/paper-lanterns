---
import Layout from '../layouts/Layout.astro';
import Navigation from '../components/Navigation.astro';
import { getSpeeches, sortByDate } from '../lib/data-layer';

const speeches = await getSpeeches();
const sortedSpeeches = sortByDate(speeches, 'desc');

const totalCount = speeches.length;
---

<Layout
  title="Speeches - Paper Lanterns"
  description="Historic speeches that moved nations and changed the world."
>
  <Navigation />

  <main>
    <section class="archive-header">
      <h1>Speeches</h1>
      <p class="archive-subtitle">
        Historic orations that moved nations and changed the world.
      </p>
    </section>

    <nav class="filter-nav">
      <div class="filter-nav-content">
        <a href="/letters" class="filter-link">Letters</a>
        <a href="/essays" class="filter-link">Essays</a>
        <a href="#" class="filter-link active" data-filter="all">All</a>
        <a href="/lectures" class="filter-link">Lectures</a>
      </div>
    </nav>

    <section class="archive-container">
      <div class="archive-grid">
        {sortedSpeeches.map((speech, index) => (
          <a href={`/speech/${speech.slug}`} class="archive-item" data-type="speech">
            <div class="archive-meta">
              <span class="archive-category">Speech</span>
              <span class="meta-separator">·</span>
              <span class="archive-date">
                {speech.data.date.toLocaleDateString('en-US', { month: 'long', day: 'numeric', year: 'numeric' })}
              </span>
            </div>
            <h3>{speech.data.title}</h3>
            <div class="archive-author">{speech.data.author.name}</div>
            <p class="archive-excerpt">
              {speech.data.excerpt.slice(0, 150)}...
            </p>
          </a>
        ))}
      </div>
    </section>

    <section class="archive-stats">
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-number">{totalCount}</div>
          <div class="stat-label">Total Speeches</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">{new Set(speeches.map(s => s.data.author.name)).size}</div>
          <div class="stat-label">Orators</div>
        </div>
        <div class="stat-item">
          <div class="stat-number">{new Set(speeches.map(s => s.data.date.getFullYear())).size}</div>
          <div class="stat-label">Years Covered</div>
        </div>
      </div>
    </section>

    <footer class="footer">
      <div class="footer-content">
        <div class="footer-brand">
          <h3>Paper Lanterns</h3>
          <p>
            A modern anthology of history's most profound correspondence—preserving words
            that shaped hearts, minds, and the human condition.
          </p>
        </div>
        <div class="footer-section">
          <h4>Browse</h4>
          <ul>
            <li><a href="/letters">All Letters</a></li>
            <li><a href="/archive">By Era</a></li>
            <li><a href="/collections">Collections</a></li>
            <li><a href="/search">Search</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Connect</h4>
          <ul>
            <li><a href="/about">About</a></li>
            <li><a href="/garden">Garden</a></li>
            <li><a href="/rss.xml">RSS Feed</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        © 2025 Paper Lanterns · All Rights Reserved
      </div>
    </footer>
  </main>
</Layout>

<style>
  /* Archive header */
  .archive-header {
    max-width: 1600px;
    margin: 0 auto;
    padding: 10vh 6vw 4vh;
  }

  .archive-header h1 {
    font-size: clamp(3rem, 6vw, 5.5rem);
    font-weight: 300;
    letter-spacing: -0.035em;
    margin-bottom: 1.5rem;
    color: var(--text-primary);
  }

  .archive-subtitle {
    font-size: 1.125rem;
    color: var(--text-tertiary);
    font-weight: 300;
    max-width: 600px;
  }

  /* Filter navigation */
  .filter-nav {
    max-width: 1600px;
    margin: 0 auto 6vh;
    padding: 0 6vw;
    border-bottom: 1px solid var(--border-secondary);
  }

  .filter-nav-content {
    display: flex;
    justify-content: flex-start;
    gap: 3rem;
    padding-bottom: 2rem;
  }

  .filter-nav a {
    font-size: 0.9375rem;
    color: var(--text-muted);
    text-decoration: none;
    font-weight: 400;
    letter-spacing: 0.01em;
    position: relative;
    padding-bottom: 0.5rem;
    transition: color 0.2s ease;
  }

  .filter-nav a.active {
    color: var(--text-primary);
  }

  .filter-nav a.active::after {
    content: '';
    position: absolute;
    bottom: -2rem;
    left: 0;
    right: 0;
    height: 2px;
    background: linear-gradient(90deg,
      rgba(239, 127, 96, 0.6) 0%,
      rgba(239, 127, 96, 0.2) 100%
    );
  }

  /* Archive grid */
  .archive-container {
    max-width: 1600px;
    margin: 0 auto 12vh;
    padding: 0 6vw;
  }

  .archive-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 0;
  }

  .archive-item {
    position: relative;
    padding: 3.5rem 3rem;
    border-right: 1px solid var(--border-secondary);
    border-bottom: 1px solid var(--border-secondary);
    text-decoration: none;
    display: block;
    background: var(--bg-primary);
    transition: background 0.2s ease;
  }

  .archive-item:hover {
    background: var(--bg-secondary);
  }

  .archive-item:nth-child(3n) {
    border-right: none;
  }

  /* Color variations */
  .archive-item:nth-child(6n+1) {
    border-left: 3px solid rgba(147, 112, 219, 0.25);
  }

  .archive-item:nth-child(6n+2) {
    border-left: 3px solid rgba(192, 132, 151, 0.25);
  }

  .archive-item:nth-child(6n+3) {
    border-left: 3px solid rgba(134, 168, 182, 0.25);
  }

  .archive-item:nth-child(6n+4) {
    border-left: 3px solid rgba(166, 143, 113, 0.25);
  }

  .archive-item:nth-child(6n+5) {
    border-left: 3px solid rgba(156, 148, 171, 0.25);
  }

  .archive-item:nth-child(6n+6) {
    border-left: 3px solid rgba(175, 139, 156, 0.25);
  }

  .archive-meta {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 2rem;
    font-size: 0.75rem;
    font-family: 'Inter', -apple-system, sans-serif;
  }

  .archive-category {
    font-size: 0.625rem;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    font-weight: 500;
  }

  .archive-item:nth-child(6n+1) .archive-category {
    color: rgba(147, 112, 219, 0.7);
  }

  .archive-item:nth-child(6n+2) .archive-category {
    color: rgba(192, 132, 151, 0.7);
  }

  .archive-item:nth-child(6n+3) .archive-category {
    color: rgba(134, 168, 182, 0.7);
  }

  .archive-item:nth-child(6n+4) .archive-category {
    color: rgba(166, 143, 113, 0.7);
  }

  .archive-item:nth-child(6n+5) .archive-category {
    color: rgba(156, 148, 171, 0.7);
  }

  .archive-item:nth-child(6n+6) .archive-category {
    color: rgba(175, 139, 156, 0.7);
  }

  .archive-date {
    color: var(--text-muted);
    letter-spacing: 0.02em;
  }

  .meta-separator {
    color: rgba(23, 23, 23, 0.2);
  }

  .archive-item h3 {
    font-size: 1.5rem;
    font-weight: 400;
    line-height: 1.3;
    margin-bottom: 1rem;
    letter-spacing: -0.015em;
    color: var(--text-primary);
  }

  .archive-author {
    font-size: 0.9375rem;
    color: var(--text-secondary);
    margin-bottom: 1.25rem;
    font-weight: 400;
  }

  .archive-excerpt {
    font-size: 0.9375rem;
    line-height: 1.7;
    color: rgba(23, 23, 23, 0.55);
    font-weight: 300;
  }

  /* Stats section */
  .archive-stats {
    max-width: 1600px;
    margin: 12vh auto;
    padding: 8vh 6vw;
    background: var(--bg-accent);
  }

  .stats-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 4rem;
  }

  .stat-item {
    text-align: center;
  }

  .stat-number {
    font-size: 3.5rem;
    font-weight: 300;
    letter-spacing: -0.02em;
    margin-bottom: 0.5rem;
    color: rgba(239, 127, 96, 0.8);
  }

  .stat-label {
    font-size: 0.8125rem;
    text-transform: uppercase;
    letter-spacing: 0.1em;
    color: var(--text-muted);
    font-weight: 500;
    font-family: 'Inter', -apple-system, sans-serif;
  }

  /* Footer */
  .footer {
    background: var(--bg-accent);
    border-top: 1px solid var(--border-secondary);
    color: var(--text-primary);
    padding: 10vh 6vw 5vh;
    margin-top: 0;
  }

  .footer-content {
    max-width: 1600px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: 2fr 1fr 1fr;
    gap: 8vw;
    padding-bottom: 5vh;
    border-bottom: 1px solid var(--border-secondary);
  }

  .footer-brand h3 {
    font-size: 0.9375rem;
    font-weight: 500;
    letter-spacing: 0.08em;
    text-transform: uppercase;
    margin-bottom: 1.5rem;
    color: var(--text-primary);
    font-family: 'Inter', -apple-system, sans-serif;
  }

  .footer-brand p {
    font-size: 0.9375rem;
    line-height: 1.8;
    color: var(--text-tertiary);
    font-weight: 300;
  }

  .footer-section h4 {
    font-size: 0.625rem;
    text-transform: uppercase;
    letter-spacing: 0.15em;
    margin-bottom: 1.5rem;
    color: var(--text-muted);
    font-weight: 500;
    font-family: 'Inter', -apple-system, sans-serif;
  }

  .footer-section ul {
    list-style: none;
  }

  .footer-section li {
    margin-bottom: 0.625rem;
  }

  .footer-section a {
    color: var(--text-tertiary);
    text-decoration: none;
    font-size: 0.8125rem;
    font-weight: 300;
    transition: color 0.2s ease;
  }

  .footer-section a:hover {
    color: var(--text-primary);
  }

  .footer-bottom {
    margin-top: 5vh;
    text-align: center;
    font-size: 0.6875rem;
    color: var(--text-light);
    letter-spacing: 0.06em;
    font-family: 'Inter', -apple-system, sans-serif;
  }

  @media (max-width: 1024px) {
    .archive-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .archive-item:nth-child(2n) {
      border-right: none;
    }

    .archive-item:nth-child(3n) {
      border-right: 1px solid var(--border-secondary);
    }

    .stats-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: 3rem;
    }

    .footer-content {
      grid-template-columns: 1fr;
      gap: 3rem;
    }
  }

  @media (max-width: 640px) {
    .archive-header {
      padding: 8vh 5vw 4vh;
    }

    .filter-nav {
      padding: 0 5vw;
    }

    .filter-nav-content {
      gap: 2rem;
      overflow-x: auto;
    }

    .filter-nav a {
      white-space: nowrap;
      font-size: 0.875rem;
    }

    .archive-container {
      padding: 0 5vw;
    }

    .archive-grid {
      grid-template-columns: 1fr;
    }

    .archive-item {
      padding: 3rem 2rem;
      border-right: none;
    }

    .archive-item:nth-child(n) {
      border-right: none;
    }

    .stats-grid {
      grid-template-columns: 1fr;
      gap: 2.5rem;
    }

    .stat-number {
      font-size: 2.5rem;
    }

    .footer {
      padding: 8vh 5vw 4vh;
    }
  }
</style>
