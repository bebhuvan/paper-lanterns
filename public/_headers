# Cache optimization for static assets
/_astro/*
  cache-control: public, max-age=31536000, immutable

# CSS and JS files with hashes - long cache
/_astro/*.css
  cache-control: public, max-age=31536000, immutable
  content-type: text/css

/_astro/*.js
  cache-control: public, max-age=31536000, immutable
  content-type: application/javascript

# Security-related JS files - medium cache
/js/*.js
  cache-control: public, max-age=86400
  content-type: application/javascript

# Images - long cache with revalidation
/images/*
  cache-control: public, max-age=2592000, stale-while-revalidate=86400

# Icons and favicons - long cache
/favicon.svg
  cache-control: public, max-age=2592000
  content-type: image/svg+xml

/icons/*
  cache-control: public, max-age=2592000

# Manifest and service worker - shorter cache
/manifest.json
  cache-control: public, max-age=86400
  content-type: application/json

/sw.js
  cache-control: public, max-age=0, must-revalidate
  content-type: application/javascript

# API endpoints - short cache with revalidation
/api/*
  cache-control: public, max-age=300, stale-while-revalidate=60
  content-type: application/json

# HTML pages - short cache with revalidation and comprehensive security
/*
  cache-control: public, max-age=300, stale-while-revalidate=86400
  
  # Security Headers
  # Content Security Policy with hash-based allowlisting for XSS and injection protection
  # SHA-256 hashes for inline scripts:
  # - Theme initialization (Layout.astro)
  # - Deferred script loader (Layout.astro)
  # - Mobile menu toggle (Navigation.astro)
  # unsafe-inline is fallback for browsers that don't support hashes (ignored by modern browsers)
  content-security-policy: default-src 'self'; script-src 'self' 'unsafe-inline' 'sha256-WtQ2lEKDRBSog25pdBOa6WJdo10E4pXVgNXK9omPvaA=' 'sha256-3MJ4Mnl3tPQC4oQawyEO2JH/plmrR9b8srlUItAXcH8=' 'sha256-c0u4fYbg2+mBT/HIC75Wz3DNbyrM0BI5+4IOCCQ6unQ=' https://static.cloudflareinsights.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' data: https://fonts.gstatic.com; img-src 'self' data: https:; connect-src 'self' https://static.cloudflareinsights.com; manifest-src 'self'; worker-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'; object-src 'none'; media-src 'self'; child-src 'none'; upgrade-insecure-requests; require-trusted-types-for 'script'
  
  # HSTS - Force HTTPS connections
  strict-transport-security: max-age=31536000; includeSubDomains; preload
  
  # Cross-Origin-Opener-Policy - Isolate browsing context
  cross-origin-opener-policy: same-origin
  
  # Cross-Origin-Embedder-Policy - Additional isolation
  cross-origin-embedder-policy: require-corp
  
  # Cross-Origin-Resource-Policy - Control cross-origin access
  cross-origin-resource-policy: same-origin
  
  # Additional security headers
  x-content-type-options: nosniff
  x-frame-options: DENY
  x-xss-protection: 1; mode=block
  referrer-policy: strict-origin-when-cross-origin
  permissions-policy: geolocation=(), microphone=(), camera=(), fullscreen=(self), payment=()

# Font optimization
/fonts/*
  cache-control: public, max-age=31536000, immutable
  access-control-allow-origin: *
